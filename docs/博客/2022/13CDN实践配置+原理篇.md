# CDNå®è·µé…ç½®+åŸç†ç¯‡

> å‰å‡ å¤©é…ç½®äº†ä¸‹è‡ªå·±åœ¨é˜¿é‡Œäº‘çš„å¯¹è±¡å­˜å‚¨ä¸­çš„CDNåŠ é€Ÿï¼Œè¿™é‡Œè®°å½•å†™ä¸ªæ•™ç¨‹ä¸ºå¼•å…¥ï¼Œæ¥è®²è§£ä¸€ä¸‹CDNçš„ç›¸å…³åŸç†åŠè¿‡ç¨‹ï¼Œå¸Œæœ›å¯¹ä½ æœ‰æ‰€å¸®åŠ©

## CDNæ¦‚å¿µ

CDNï¼ˆContent Delivery Networkï¼Œ**å†…å®¹åˆ†å‘ç½‘ç»œ**ï¼‰æ˜¯æŒ‡ä¸€ç§é€šè¿‡äº’è”ç½‘äº’ç›¸è¿æ¥çš„ç”µè„‘ç½‘ç»œç³»ç»Ÿï¼Œåˆ©ç”¨æœ€é è¿‘æ¯ä½ç”¨æˆ·çš„æœåŠ¡å™¨ï¼Œæ›´å¿«ã€æ›´å¯é åœ°å°†éŸ³ä¹ã€å›¾ç‰‡ã€è§†é¢‘ã€åº”ç”¨ç¨‹åºåŠå…¶ä»–æ–‡ä»¶å‘é€ç»™ç”¨æˆ·ï¼Œæ¥æä¾›é«˜æ€§èƒ½ã€å¯æ‰©å±•æ€§åŠä½æˆæœ¬çš„ç½‘ç»œå†…å®¹ä¼ é€’ç»™ç”¨æˆ·ã€‚

## CDNä½œç”¨

CDNä¸€èˆ¬ä¼šç”¨æ¥æ‰˜ç®¡Webèµ„æºï¼ˆåŒ…æ‹¬æ–‡æœ¬ã€å›¾ç‰‡å’Œè„šæœ¬ç­‰ï¼‰ï¼Œå¯ä¾›ä¸‹è½½çš„èµ„æºï¼ˆåª’ä½“æ–‡ä»¶ã€è½¯ä»¶ã€æ–‡æ¡£ç­‰ï¼‰ï¼Œåº”ç”¨ç¨‹åºï¼ˆé—¨æˆ·ç½‘ç«™ç­‰ï¼‰ã€‚ä½¿ç”¨CDNæ¥åŠ é€Ÿè¿™äº›èµ„æºçš„è®¿é—®ã€‚

ï¼ˆ1ï¼‰åœ¨æ€§èƒ½æ–¹é¢ï¼Œå¼•å…¥CDNçš„ä½œç”¨åœ¨äºï¼š

- ç”¨æˆ·æ”¶åˆ°çš„å†…å®¹æ¥è‡ªæœ€è¿‘çš„æ•°æ®ä¸­å¿ƒï¼Œå»¶è¿Ÿæ›´ä½ï¼Œå†…å®¹åŠ è½½æ›´å¿«
- éƒ¨åˆ†èµ„æºè¯·æ±‚åˆ†é…ç»™äº†CDNï¼Œå‡å°‘äº†æœåŠ¡å™¨çš„è´Ÿè½½

ï¼ˆ2ï¼‰åœ¨å®‰å…¨æ–¹é¢ï¼ŒCDNæœ‰åŠ©äºé˜²å¾¡DDoSã€MITMç­‰ç½‘ç»œæ”»å‡»ï¼š

- é’ˆå¯¹DDoSï¼šé€šè¿‡ç›‘æ§åˆ†æå¼‚å¸¸æµé‡ï¼Œé™åˆ¶å…¶è¯·æ±‚é¢‘ç‡
- é’ˆå¯¹MITMï¼šä»æºæœåŠ¡å™¨åˆ° CDN èŠ‚ç‚¹åˆ° ISPï¼ˆInternet Service Providerï¼‰ï¼Œå…¨é“¾è·¯ HTTPS é€šä¿¡

é™¤æ­¤ä¹‹å¤–ï¼ŒCDNä½œä¸ºä¸€ç§åŸºç¡€çš„äº‘æœåŠ¡ï¼ŒåŒæ ·å…·æœ‰èµ„æºæ‰˜ç®¡ã€æŒ‰éœ€æ‰©å±•ï¼ˆèƒ½å¤Ÿåº”å¯¹æµé‡é«˜å³°ï¼‰ç­‰æ–¹é¢çš„ä¼˜åŠ¿ã€‚

## ç›´æ¥ä¸Šæ‰‹é…ç½®

> å‰ææ˜¯ä½ å·²ç»å¼€é€šäº†å¯¹è±¡å­˜å‚¨ï¼Œæœ¬éƒ¨åˆ†æ•™ç¨‹ä»…ä»‹ç»ä»å¯¹è±¡å­˜å‚¨â†’CDNåŠ é€Ÿï¼Œå¹¶ä»¥æ­¤ä¸ºå¼•ï¼Œå¸®åŠ©å›å¿†ä¸€ä¸‹CDNçš„åŸç†åŠè¿‡ç¨‹;

æ§åˆ¶å°ä¸­è¿›å…¥å¯¹è±¡å­˜å‚¨åº”è¯¥æ˜¯è¿™ä¸ªæ ·å­:

![](https://oss.justin3go.com/blogs/Pasted%20image%2020221114204713.png)

è¿˜æœ‰å°±æ˜¯ä½ åº”è¯¥åœ¨æ­¤ä¹‹å‰å‡†å¤‡ä¸€ä¸ªåŸŸåï¼Œå› ä¸ºCDNæœ¬è´¨ä¸Šå°±æ˜¯åˆ©ç”¨äº†DNSï¼Œåç»­åŸç†ç¯‡ä¼šè®²åˆ°ï¼Œæ‰€ä»¥éœ€è¦ä¸€ä¸ªåŸŸåï¼ŒåŒæ—¶ï¼Œå¦‚æœä½ éœ€è¦HTTPSè®¿é—®ï¼Œä½ è¿˜éœ€è¦å‡†å¤‡ä¸€ä¸ªSSLè¯ä¹¦ï¼Œè¿™ä¸ªæœ¬ç« èŠ‚ä¸è¯¦ç»†æ¶‰åŠï¼Œè¯·è‡ªè¡Œé…ç½®ï¼›

![](https://oss.justin3go.com/blogs/Pasted%20image%2020221114211106.png)

æˆ‘è¿™é‡Œå°±ä¸é‡æ–°ä»é›¶é…ç½®äº†ï¼Œç›´æ¥ä»å·²ç»é…ç½®çš„åœ°æ–¹å¼€å§‹è®²è®²ï¼Œè¯¦ç»†é…ç½®æ•™ç¨‹å¯ä»¥çœ‹è¿™ä¸ª[å‚è€ƒé“¾æ¥](https://help.aliyun.com/document_detail/123227.html?spm=5176.8466035.help.dexternal.6fac1450P7o0TQ#task-1937766)

æˆ‘ä»¬ä»ä¸Šé¢å›¾ä¸­ç®­å¤´æŒ‡å‘çš„é“¾æ¥è¿›å…¥å¯ä»¥çœ‹åˆ°CDNç›¸å…³çš„é…ç½®ä¿¡æ¯ï¼Œæœ‰å¦‚ä¸‹ä¸¤ä¸ªåœ°æ–¹å€¼å¾—æ³¨æ„ï¼š

![](https://oss.justin3go.com/blogs/Pasted%20image%2020221114212320.png)

- CNAMEï¼šå¯ç”¨CDNåŠ é€ŸæœåŠ¡éœ€è¦å°†åŠ é€ŸåŸŸåæŒ‡å‘CNAMEåœ°å€ï¼Œè¿™æ ·è®¿é—®åŠ é€ŸåŸŸåçš„è¯·æ±‚æ‰èƒ½è½¬å‘åˆ°CDNèŠ‚ç‚¹ä¸Šï¼Œåœ¨è¿™é‡Œå°±æ˜¯æˆ‘ä»¬çš„`oss.justin3go.com => CNAME`
- åŸç«™åŸŸåï¼šæˆ‘ä»¬å¯¹è±¡å­˜å‚¨ä¸­é˜¿é‡Œäº‘è‡ªåŠ¨ç»™çš„ä¸€ä¸ªè®¿é—®åŸŸåï¼Œä¸€èˆ¬æ¥è¯´æ˜¯éå¸¸é•¿ä¸€ä¸²çš„ä¸€ä¸ªåœ°å€
- æˆ‘ä»¬è‡ªå·±çš„åŸŸåï¼šæˆ‘ä»¬æƒ³è¦å¤–ç•Œé€šè¿‡è¿™ä¸ªæ¥è®¿é—®çš„ä¸€ä¸ªåŸŸåï¼Œæˆ‘è¿™é‡Œå°±æ˜¯`oss.justin3go.com`

å¯ä»¥çœ‹åˆ°è¿™é‡Œæœ‰ä¸‰ä¸ªåœ°å€ï¼ˆåŸŸåï¼‰ï¼Œé‚£æˆ‘ä»¬è¯¥å¦‚ä½•è¿›è¡Œè§£æå‘¢ï¼Ÿå°±æ˜¯è¯¥å¦‚ä½•è¿›è¡ŒåŸŸåæ˜ å°„ï¼Œè¿™å°±éœ€è¦æˆ‘ä»¬ç®€å•äº†è§£ä¸€ä¸‹CDNçš„åŸç†äº†ï¼Œè¿™æ—¶å€™ä¹‹å‰è®°å¿†çš„å…«è‚¡æ–‡çŸ¥è¯†å°±è¢«å”¤é†’äº†...

å…ˆè¯´æ˜¯å¦‚ä½•æ˜ å°„çš„ï¼š

![](https://oss.justin3go.com/blogs/Pasted%20image%2020221114213906.png)

`oss.justin3go.com => CDNåŠ é€Ÿçš„CNAME`

è€Œå‰é¢é‚£ç§å›¾ï¼ˆä»è¿™å¾€ä¸Šæ•°ç¬¬äºŒå¼ å›¾ï¼‰ä¸­ä¹Ÿé…ç½®äº†åŸç«™ä¿¡æ¯`CDNåŠ é€Ÿçš„CANME => åŸç«™ossåŸŸå`

## å¸¸è§çš„ossé…ç½®æ–¹å¼

æ‰€ä»¥ç»¼ä¸Šæœ€åçš„åŸŸåæ˜ å°„å…³ç³»å°±æ˜¯ä¸‹å›¾ä¸­çš„æ–¹æ¡ˆå››ï¼š

![](https://oss.justin3go.com/blogs/CDN%E5%90%84%E5%9F%9F%E5%90%8D%E6%98%A0%E5%B0%84%E5%85%B3%E7%B3%BB.png)

å¯¹äºé…ç½®ossæœ‰å¦‚ä¸Šå¦‚ä¸‹å››ç§æ–¹æ¡ˆï¼ˆå¾ˆåŸºæœ¬çš„ä¸œè¥¿ï¼Œè¿™é‡Œç®€å•åšä¸ªå¯¹æ¯”æ–¹ä¾¿å¤§å®¶ç†è§£ï¼‰ï¼š

- æ–¹æ¡ˆä¸€ï¼šç”¨æˆ·ç›´æ¥æ–¹æ¡ˆossåŸŸå
- æ–¹æ¡ˆäºŒï¼šä½¿ç”¨æˆ‘ä»¬è‡ªå·±çš„åŸŸåå¯¹ossåŸŸåè§£æï¼Œæ–¹ä¾¿è®°å¿†ï¼Œå°±æ˜¯æˆ‘ä»¬å¹³å¸¸åŸŸåæ‹¿æ¥è§£æipåœ°å€çš„ä½œç”¨ï¼Œä¹Ÿæ˜¯æ˜ å°„ä½œç”¨
- æ–¹æ¡ˆä¸‰ï¼šä½¿ç”¨CDNåŠ é€Ÿï¼Œæœ‰CDNçš„ä¼˜åŠ¿ï¼Œå¦‚è®¿é—®é€Ÿåº¦å¿«
- æ–¹æ¡ˆå››ï¼šä½¿ç”¨è‡ªå·±çš„åŸŸåå¯¹CDNåŸŸåè¿›è¡Œè§£æï¼Œæœ‰æ–¹æ¡ˆäºŒå’Œæ–¹æ¡ˆä¸‰çš„ç»“åˆä¼˜åŠ¿

## CDNåŸç†ç¯‡

è¿™å°èŠ‚ä¸»è¦è§£å†³è¿™ä¸ªé—®é¢˜â€œä¸ºä»€ä¹ˆCDNåŠ é€Ÿéœ€è¦å•ç‹¬ä¸€ä¸ªåŸŸåâ€

å›ç­”ä¹Ÿå¾ˆç®€å•ï¼Œå°±æ˜¯CDNæœ¬è´¨ä¸Šä½¿ç”¨äº†DNSè§£ææ¥åšåˆ°è®¿é—®æœ€è¿‘çš„èŠ‚ç‚¹èµ„æºï¼Œæ¥ä¸‹æ¥é€šè¿‡ä¸‹é¢è¿™å¼ å›¾è¯¦ç»†è¯´ä¸€ä¸‹CDNæ•´ä¸ªä¸€ä¸ªè®¿é—®è¿‡ç¨‹:

![](https://oss.justin3go.com/blogs/CDN%E5%8E%9F%E7%90%86%E6%AD%A5%E9%AA%A4%E5%9B%BE.png)

**ç”¨æˆ·æœªä½¿ç”¨CDNç¼“å­˜èµ„æºçš„è¿‡ç¨‹ï¼š**

1. æµè§ˆå™¨é€šè¿‡DNSå¯¹åŸŸåè¿›è¡Œè§£æï¼ˆå°±æ˜¯åŸºæœ¬çš„DNSè§£æè¿‡ç¨‹ï¼‰ï¼Œä¾æ¬¡å¾—åˆ°æ­¤åŸŸåå¯¹åº”çš„IPåœ°å€
2. æµè§ˆå™¨æ ¹æ®å¾—åˆ°çš„IPåœ°å€ï¼Œå‘åŸŸåçš„æœåŠ¡ä¸»æœºå‘é€æ•°æ®è¯·æ±‚
3. æœåŠ¡å™¨å‘æµè§ˆå™¨è¿”å›å“åº”æ•°æ®

**ç”¨æˆ·ä½¿ç”¨CDNç¼“å­˜èµ„æºçš„è¿‡ç¨‹ï¼š**

1. å¯¹äºç‚¹å‡»çš„æ•°æ®çš„URLï¼Œç»è¿‡æœ¬åœ°DNSç³»ç»Ÿçš„è§£æï¼Œå‘ç°è¯¥URLå¯¹åº”çš„æ˜¯ä¸€ä¸ªCDNä¸“ç”¨çš„DNSæœåŠ¡å™¨ï¼ŒDNSç³»ç»Ÿå°±ä¼šå°†åŸŸåè§£ææƒäº¤ç»™CNAMEæŒ‡å‘çš„CDNä¸“ç”¨çš„DNSæœåŠ¡å™¨ã€‚
2. CNDä¸“ç”¨DNSæœåŠ¡å™¨å°†CNDçš„å…¨å±€è´Ÿè½½å‡è¡¡è®¾å¤‡IPåœ°å€è¿”å›ç»™ç”¨æˆ·
3. ç”¨æˆ·å‘CDNçš„å…¨å±€è´Ÿè½½å‡è¡¡è®¾å¤‡å‘èµ·æ•°æ®è¯·æ±‚
4. CDNçš„å…¨å±€è´Ÿè½½å‡è¡¡è®¾å¤‡æ ¹æ®ç”¨æˆ·çš„IPåœ°å€ï¼Œä»¥åŠç”¨æˆ·è¯·æ±‚çš„å†…å®¹URLï¼Œé€‰æ‹©ä¸€å°ç”¨æˆ·æ‰€å±åŒºåŸŸçš„åŒºåŸŸè´Ÿè½½å‡è¡¡è®¾å¤‡ï¼Œå‘Šè¯‰ç”¨æˆ·å‘è¿™å°è®¾å¤‡å‘èµ·è¯·æ±‚
5. åŒºåŸŸè´Ÿè½½å‡è¡¡è®¾å¤‡é€‰æ‹©ä¸€å°åˆé€‚çš„ç¼“å­˜æœåŠ¡å™¨æ¥æä¾›æœåŠ¡ï¼Œå°†è¯¥ç¼“å­˜æœåŠ¡å™¨çš„IPåœ°å€è¿”å›ç»™å…¨å±€è´Ÿè½½å‡è¡¡è®¾å¤‡
6. å…¨å±€è´Ÿè½½å‡è¡¡è®¾å¤‡æŠŠæœåŠ¡å™¨çš„IPåœ°å€è¿”å›ç»™ç”¨æˆ·
7. ç”¨æˆ·å‘è¯¥ç¼“å­˜æœåŠ¡å™¨å‘èµ·è¯·æ±‚ï¼Œç¼“å­˜æœåŠ¡å™¨å“åº”ç”¨æˆ·çš„è¯·æ±‚ï¼Œå°†ç”¨æˆ·æ‰€éœ€å†…å®¹å‘é€è‡³ç”¨æˆ·ç»ˆç«¯ã€‚

**ç»“åˆåˆšæ‰é…ç½®é˜¿é‡Œäº‘CDNçš„è¿‡ç¨‹**

1. ç”¨æˆ·è®¿é—®`oss.justin3go.com`
2. æœ¬åœ°DNSè¿›è¡Œè§£æå‘ç°`oss.justin3go.com`å¯¹åº”çš„æ˜¯`CDNåŠ é€ŸåŸŸå`ï¼Œäºæ˜¯å°†åŸŸåè§£ææƒäº¤ç»™CDNä¸“ç”¨çš„DNSæœåŠ¡å™¨ï¼Œè¯¥ä¸“ç”¨DNSæœåŠ¡å™¨è¿”å›`CDNåŠ é€ŸåŸŸå`
3. ç”¨æˆ·è¯·æ±‚`CDNåŠ é€ŸåŸŸå`ï¼Œé€šè¿‡è´Ÿè½½å‡è¡¡è¿”å›ç¦»ç”¨æˆ·æœ€è¿‘çš„ä¸€ä¸ªèŠ‚ç‚¹èµ„æºï¼›

> æˆ‘ä»¬çš„`ossåŸç«™åœ°å€`ä¼šåœ¨CDNä¼šå®šæœŸåŒæ­¥èµ„æºåˆ°å„ä¸ªç¼“å­˜æœåŠ¡å™¨çš„æ—¶å€™ä½¿ç”¨ï¼Œå¹¶ä¸”å¦‚æœè¿˜æœªåŒæ­¥æ—¶ï¼Œå³ç¼“å­˜æœåŠ¡å™¨è¿˜æ²¡æˆ‘ä»¬å°†è®¿é—®çš„èµ„æºæ—¶ï¼Œä¼šç›´æ¥è¿”å›`ossåŸç«™åœ°å€`

## æœ€å

æœ‰äº›ç»†èŠ‚éƒ¨åˆ†å¹¶æ²¡æœ‰ä¸€ä¸€éªŒè¯ï¼Œå¦‚æœæˆ‘ç†è§£æœ‰è¯¯çš„è¯ï¼Œæ¬¢è¿å‹å–„æŒ‡å‡ºğŸ‰

## å‚è€ƒ
- https://help.aliyun.com/document_detail/123227.html?spm=5176.8466035.help.dexternal.6fac1450P7o0TQ#task-1937766
- https://help.aliyun.com/document_detail/27101.html?spm=5176.8466035.help.dexternal.6fac1450P7o0TQ
- https://juejin.cn/post/6987688566520299528
- https://juejin.cn/post/6941278592215515143

